var TbMsgSys;!function(){var e={};e.Type=function(e,t){var r=this;this.name={},this.body={};var n=function(){r.name=e;for(var n in t)r.body[n]=!0};n()},e.TypeManager=new function(){var t={};this.addType=function(r,n){return t[r]?!1:(t[r]=new e.Type(r,n),!0)},this.removeType=function(e){t.hasOwnProperty(e)&&(t[e]=null,delete t[e])},this.getType=function(e){return t[e]?t[e]:null}},e.CheckBox=function(){var t=e.TypeManager;this.checkMsg=function(e){var r=!0;if(!(e&&e.hasOwnProperty("head")&&e.hasOwnProperty("body")&&e.head.type))return alert("\u6d88\u606f\u4e0d\u5b8c\u6574"),!1;var n=t.getType(e.head.type);if(!n)return alert("\u6d88\u606f\u7c7b\u578b\u4e0d\u5b58\u5728\uff01"),!1;for(var s in n.body)if(!e.body.hasOwnProperty(s)){alert("\u6d88\u606f\u4f53\u7ed3\u6784\u4e0d\u5b8c\u6574\uff01"),r=!1;break}return r}},e.Setup=function(){var t=this,r=new e.CheckBox;this.setType=function(e,t){return e.head.type=t,e},this.setTo=function(e,t){var r=$.extend({},e);return r.head.to=t,r},this.setFrom=function(e,t){var r=$.extend({},e);return r.head.from=t,r},this.setBody=function(e,t){var n=$.extend({},e);return n.body=t,r.checkMsg(n)?n:!1},this.set=function(e,r,n,s,i){var o=t.setType(e,r);return o=t.setFrom(e,n),o=t.setTo(e,s),o=t.setBody(e,i)}},e.Assembly=new function(){var t=e.TypeManager,r=new e.CheckBox,n=new e.Setup;this.typeManager=function(){return t},this.checkBox=function(){return r},this.setup=function(){return n}},e.Message=function(){var e=this;this.head={type:"default",from:"",to:""},this.body={},this.getType=function(){return e.head.type},this.getFrom=function(){return e.head.from},this.getTo=function(){return e.head.to}},e.Generator=function(){var t=e.Assembly;this.getNewMessage=function(r,n,s,i){var o=new e.Message;return t.setup().set(o,r,n,s,i)}},e.MsgQue=function(e,t){var r,n,s=0,i=this,o=function(){n=new Array,s=t,r=e};this.add=function(e){i.isFull()||n.push(e)},this.get=function(){return i.isEmpty()?null:n.shift()},this.isEmpty=function(){return!(n.length>0)},this.isFull=function(){return!!(s>0&&n.length>=s)},this.getSize=function(){return n.length},this.pop=function(){n.pop()},this.getId=function(){return r},this.clear=function(){n=new Array},o()},e.processor=function(){var e=!1,t=null,r={};this.process=function(n){t=n,e=!0;var s=n.getType(),i=n.getTo(),o=n.getFrom();if(r.hasOwnProperty(s)&&"function"==typeof r[s]){var u=r[s].call(n,s,i,o,n.body);return t=null,e=!1,u}return t=null,e=!1,!1},this.setProcess=function(e,t){r[e]=t},this.getCurrentMsg=function(){return t}},e.Server=function(t){var r=(e.Assembly,{}),n=new e.processor;this.recieve=function(e){return n.process(e)},this.sendToQueue=function(t){var n=t.getTo();r.hasOwnProperty(n)&&r[n]||(r[n]=new e.MsgQue(n)),r[n].add(t)},this.getMsgQueues=function(){return r},this.setProcessor=function(e,t){n.setProcess(e,t)}},e.Servers=new function(){{var t={};e.Assembly}this.addServer=function(r){t.hasOwnProperty(r)&&t[r]||(t[r]=new e.Server(r))},this.getServer=function(e){return t[e]||null},this.getAllServer=function(){return t},this.removeServer=function(e){delete t[e]}},e.Distributor=new function(){var t=e.Servers,r=e.Assembly;this.distribute=function(e){if(!r.checkBox().checkMsg(e))return!1;var n=t.getServer(e.getTo()),s=t.getServer(e.getFrom());return n?this.recieve(e):(s.sendToQueue(e),!1)},this.recieve=function(e){var r=t.getServer(e.getTo());return r?r.recieve(e):!1}},e.MsgManager=new function(){var t=e.Assembly,r=new e.Generator,n=e.Servers,s=e.Distributor,i=this,o={system:{state:!0,msg:!0}},u=function(){for(var e in o)i.addMsgType(e,o[e])},a=function(e,t,r,s){if("system"==e&&"init"==s.state){var i=n.getServer(t),o=i.getMsgQueues();for(var u in o){var a=o[u];a&&!a.isEmpty()&&c(a)}}},c=function(e){if(!e.isEmpty()){var t=e.get();s.distribute(t),setTimeout(function(){c(e)},50)}};this.addMsgType=function(e,r){t.typeManager().addType(e,r)},this.removeMsgType=function(e){t.typeManager().removeType(e)},this.checkMsg=function(e){return t.checkBox().checkMsg(e)},this.sendMsg=function(e,t,n,i){var o=r.getNewMessage(e,t,n,i);return o?s.distribute(o):!1},this.sendMsgToAll=function(e,t,i){var o=n.getAllServer();for(var u in o)if(u!=t){var a=r.getNewMessage(e,t,u,i);a&&s.distribute(a)}},this.setProcessor=function(e,t,r){var s=n.getServer(e);return s?(s.setProcessor(t,r),!0):!1},this.registerServer=function(e){n.addServer(e),this.setProcessor(e,"system",a)},this.initedServer=function(e){this.sendMsgToAll("system",e,{state:"init",msg:!0})},u()},TbMsgSys=e.MsgManager}();var TbCom,TbComMsName="ComManager",MsgSystem=MsgSystem||{need_start:!0},Events={on:function(t,e,s){var o;t=t.split(/\s+/);for(var n=this._callbacks||(this._callbacks={});o=t.shift();){var i=n[o]||(n[o]={}),r=i.tail||(i.tail=i.next={});r.callback=e,r.context=s,i.tail=r.next={}}return this},off:function(t,e,s){var o,n,i;if(t){if(n=this._callbacks)for(t=t.split(/\s+/);o=t.shift();)if(i=n[o],delete n[o],e&&i)for(;(i=i.next)&&i.next;)(i.callback!==e||s&&i.context!==s)&&this.on(o,i.callback,i.context)}else delete this._callbacks;return this},trigger:function(t){var e,s,o,n,i,r,c;if(!(o=this._callbacks))return this;for(r=o.all,(t=t.split(/\s+/)).push(null);e=t.shift();)r&&t.push({next:r.next,tail:r.tail,event:e}),(s=o[e])&&t.push({next:s.next,tail:s.tail});for(c=Array.prototype.slice.call(arguments,1);s=t.pop();)for(n=s.tail,i=s.event?[s.event].concat(c):c;(s=s.next)!==n;)s.callback.apply(s.context||this,i);return this}};!function(){var t="undefined"==typeof _VERSION?{}:_VERSION,e={staticVersion:18.58,comlist:{PassportFillName:{inited:!1,url:"/tb/static-common/"+(t["component/commonLogic/common/passport/PassportFillName.js"]||"component/commonLogic/common/passport/PassportFillName.js")},PassportSign:{inited:!1,url:"/tb/static-common/"+(t["component/commonLogic/common/passport/PassportLogin.js"]||"component/commonLogic/common/passport/PassportLogin.js")},PassportRegister:{inited:!1,url:"/tb/static-common/"+(t["component/commonLogic/common/passport/PassportRegister.js"]||"component/commonLogic/common/passport/PassportRegister.js")},User:{inited:!1,url:"/tb/static-common/"+(t["component/commonLogic/common/user/User.js"]||"js/common/user/User.js")},UserBar:{inited:!1,url:"/tb/static-common/"+(t["component/commonLogic/common/user/UserBar.js"]||"component/commonLogic/common/user/UserBar.js")},Suggestion:{inited:!1,url:"/tb/static-common/"+(t["component/commonLogic/common/suggestion/Suggestion.js"]||"component/commonLogic/common/suggestion/Suggestion.js")},Poptip:{inited:!1,url:"/tb/static-common/"+(t["component/commonLogic/common/poptip/Poptip.js"]||"component/commonLogic/common/poptip/Poptip.js")},WealthSystem:{inited:!1,url:"/tb/static-common/"+(t["component/commonLogic/common/wealth/WealthSystem.js"]||"component/commonLogic/common/wealth/WealthSystem.js")},Search:{inited:!1,url:"/tb/static-common/"+(t["component/commonLogic/common/search/Search.js"]||"component/commonLogic/common/search/Search.js")},MsgSystem:{inited:!1,url:"/tb/static-common/js/common/crosspage_msg_system/MsgSystem.js"},UserMessage:{inited:!1,url:"/tb/static-common/js/common/user_message/UserMessage.js"}},defualtMerger:["User","UserBar","Suggestion","Poptip","WealthSystem"],error:{SUCCESS:0,COM_NOT_FOUND:1,METHOD_NOT_FOUND:2,PROCESS_ERROR:3}},s=function(t,e){var s=t,o=e;this.error=function(){return s},this.result=function(){return o}},o=function(){var t=arguments[0];this.createPars=function(e){for(var s=[],o=e;o<t.length;o++)s.push(t[o]);return s}},n=new function(){this.process=function(){if(arguments.length<2)return new s(e.error.PROCESS_ERROR);var t=arguments[0],n=arguments[1];if(!t||!e.comlist[t].inited)return new s(e.error.COM_NOT_FOUND);if(!t.hasOwnProperty(n)||"function"!=typeof t[n])return new s(e.error.METHOD_NOT_FOUND);var i=new o(arguments).createPars(2),r=TbMsgSys.sendMsg("process",TbComMsName,t,{method:arguments[1],params:i});return new s(e.error.SUCCESS,r)}},i=new function(){var t=e,s={},i={User:!0,UserBar:!0,Suggestion:!0,Poptip:!0,MsgSystem:!0,UserMessage:!0},r=function(){var t={process:{method:!0,params:!0},loadCom:{com:!0},needCom:{coms:!0}};TbMsgSys.registerServer(TbComMsName);for(var e in t)TbMsgSys.addMsgType(e,t[e]);TbMsgSys.setProcessor(TbComMsName,"needCom",c),TbMsgSys.initedServer(TbComMsName),$.console.debug("\u6a21\u5757\uff1a"+TbComMsName+" \u6fc0\u6d3b\uff01"),$.console.debug("\u6a21\u5757\uff1a"+TbComMsName+" \u6fc0\u6d3b\uff01\u51c6\u5907\u5f00\u59cb\u52a0\u8f7d\u9ed8\u8ba4\u5408\u5e76\u9759\u6001\u6587\u4ef6!")},c=function(t,e,s){m(s)},m=function(e){t.comlist[e].inited=!0,TbMsgSys.initedServer(e),$.console.debug("\u6a21\u5757\uff1a"+e+" \u6fc0\u6d3b\uff01"),n.process(e,"init"),delete s[e]};this.process=function(t,e){var s=new o(arguments).createPars(2);return TbMsgSys.sendMsg("process",TbComMsName,t,{method:e,params:s})},this.addEvent=function(t,e,s){return this.process(t,"addEvent",e,s)},this.removeEvent=function(t,e,s){return this.process(t,"removeEvent",e,s)},this.setNeedStartConfig=function(t){t&&"object"==typeof t&&$.extend(i,t)},this.defaultLogicInit=function(t,s,o,n,r){var c=n||null;"undefined"!=typeof r&&(e.staticVersion=r),this.setNeedStartConfig(o),i.User&&(this.process("User","init",t,s),i.UserBar&&this.process("UserBar","init",c)),i.Suggestion&&this.process("Suggestion","createMainSearchSuggestion"),!t.is_login||t.no_un||!i.MsgSystem||MsgSystem&&MsgSystem.hasOwnProperty("need_start")&&MsgSystem.need_start!==!0||(this.process("MsgSystem","init"),i.UserMessage&&this.process("UserMessage","init",s,c))},r()};TbCom=i,$.extend(TbCom,Events)}();var TbICom=function(){var t,e,s=!1,o=this,n=[];this.processMsgHandler=function(t,s,n,i){var r=i.params,c=i.method;return e[c]&&"function"==typeof e[c]?e[c].apply(o,r):($.console.error("\u627e\u4e0d\u5230\u65b9\u6cd5: "+c),!1)},this.initSys=function(o,i,r){s||(t=o,$.extend(e,r),n=i,TbMsgSys.registerServer(t),TbMsgSys.setProcessor(t,"process",this.processMsgHandler),TbMsgSys.sendMsg("needCom",t,"ComManager",{coms:n}),s=!0,$.console.debug("\u6a21\u5757: "+o+" initSys\uff01\u4f9d\u8d56\uff1a"+i))},this.init=function(){},this.getRelationship=function(){return n},this.getId=function(){return t},this.getInited=function(){return s},this.addEvent=function(t,e){$(o).bind(t,e)},this.removeEvent=function(t,e){$(o).unbind(t,e)},this.dispatchEvent=function(){$(o).trigger.apply($(o),arguments)},e={init:this.init,addEvent:this.addEvent,removeEvent:this.removeEvent,dispatchEvent:this.dispatchEvent,getId:this.getId,getRelationship:this.getRelationship,getInited:this.getInited}};var bdPass=bdPass||{};!function(){var baidu={version:"1-0-0",emptyFn:function(){}};if(baidu.isString=function(e){return"object"==typeof e&&e&&e.constructor==String||"string"==typeof e},baidu.sio=baidu.sio||{},baidu.url=baidu.url||{},baidu.string=baidu.string||{},baidu.string.escapeReg=function(e){return String(e).replace(new RegExp("([.*+?^=!:${}()|[\\]/\\\\])","g"),"\\$1")},baidu.url.parseQuery=function(e,n){if(n){var r=new RegExp("(^|&|\\?|#)"+baidu.string.escapeReg(n)+"=([^&]*)(&|$)",""),o=e.match(r);if(o)return o[2]}else if(e){e=e.substr(e.indexOf("?")+1,e.length);for(var t,a,i,s=e.split("&"),l={},d=0;d<s.length;d++)if(t=s[d].split("="),a=t[0],i=t[1],""!==a)if("undefined"==typeof l[a])l[a]=i;else{if(baidu.isString(l[a]))continue;l[a].push(i)}return l}return null},baidu.sio.get=function(e,n){if(!e||!baidu.isString(e))return null;var r=baidu.url.parseQuery(e,"callback"),o=document.createElement("SCRIPT");if(r){var t="CB"+Math.floor(2147483648*Math.random()).toString(36);e=e.replace(/(&|\?)callback=([^&]*)/,"$1callback="+t),window[t]=function(){try{var e=n||window[r];e.apply(null,arguments)}finally{o&&o.parentNode&&o.parentNode.removeChild(o),o=null,window[t]=null}}}else{var a=!1;o.onreadystatechange=o.onload=function(){if(a)return!1;if("undefined"==typeof o.readyState||"loaded"==o.readyState||"complete"==o.readyState){a=!0;try{n()}finally{o&&o.parentNode&&o.parentNode.removeChild(o),o.onreadystatechange=null,o.onload=null,o=null}}}}o.src=e,o.type="text/javascript";var i=document.getElementsByTagName("HEAD")[0];i.insertBefore(o,i.firstChild)},!bdPass.ShellTemplate){var shell=function(){var bdTarget,bdConfig,bdType,json,st,busyFlag=!1,preUrl="//passport.baidu.com/api/?",errorHash={login:{"-1":"no-token"},reg:{"-1":"no-token"},lockmail:{1:"no-token",2:"need-login",20:"system-error"},lockphone:{1:"no-token",2:"need-login",20:"system-error"}},packUrl=function(e,n){var r=[];return void 0!=n.code&&(r.push("code="+n.code),r.push("oe=gbk")),r.push("tpl="+n.tpl),r.push("callback=getPassJs"),preUrl+e+"&"+r.join("&")},getPassJs=function(v,obj){if("string"==typeof v&&(v=eval(v)),json=v,errorHash[bdType][json.error_no]){var error_no=errorHash[bdType][json.error_no];switch(error_no){case"need-login":return bdConfig.onNotLogin&&bdConfig.onNotLogin(),void 0;case"no-token":return bdConfig.onSystemError&&bdConfig.onSystemError(),void 0;case"system-error":bdConfig.onSystemError&&bdConfig.onSystemError()}}var link=json.jslink;baidu.sio.get(link,renderCallback)},renderCallback=function(){var e=bdType.charAt(0).toUpperCase()+bdType.slice(1)+"Template";bdPass[e].render(json,bdTarget,bdConfig),busyFlag=!1},callJson=function(){var e=packUrl(bdType,bdConfig);baidu.sio.get(e,getPassJs)},init=function(e,n,r){bdType=e,bdTarget=n,bdConfig=r,callJson()};return{render:function(e,n,r){busyFlag?st=setTimeout(function(){shell.render(e,n,r)},300):(busyFlag=!0,clearTimeout(st),init(e,n,r)),r.tpl||alert("\u9700\u8981tpl")}}}();bdPass.ShellTemplate=shell}}();window.baidu=window.T=window.baidu||{version:"1.3.9"},baidu.guid="$BAIDU$",window[baidu.guid]=window[baidu.guid]||{},baidu.dom=baidu.dom||{},baidu.dom.g=function(e){return"string"==typeof e||e instanceof String?document.getElementById(e):e&&e.nodeName&&(1==e.nodeType||9==e.nodeType)?e:null},baidu.g=baidu.G=baidu.dom.g,baidu.browser=baidu.browser||{},baidu.browser.ie=baidu.ie=/msie (\d+\.\d+)/i.test(navigator.userAgent)?document.documentMode||+RegExp.$1:void 0,baidu.dom._NAME_ATTRS=function(){var e={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",usemap:"useMap",frameborder:"frameBorder"};return baidu.browser.ie<8?(e["for"]="htmlFor",e["class"]="className"):(e.htmlFor="for",e.className="class"),e}(),baidu.dom.setAttr=function(e,t,n){return e=baidu.dom.g(e),"style"==t?e.style.cssText=n:(t=baidu.dom._NAME_ATTRS[t]||t,e.setAttribute(t,n)),e},baidu.setAttr=baidu.dom.setAttr,baidu.dom.setAttrs=function(e,t){e=baidu.dom.g(e);for(var n in t)baidu.dom.setAttr(e,n,t[n]);return e},baidu.setAttrs=baidu.dom.setAttrs,baidu.dom.create=function(e,t){var n=document.createElement(e),a=t||{};return baidu.dom.setAttrs(n,a)},baidu.lang=baidu.lang||{},baidu.lang.isString=function(e){return"[object String]"==Object.prototype.toString.call(e)},baidu.isString=baidu.lang.isString,baidu.dom._g=function(e){return baidu.lang.isString(e)?document.getElementById(e):e},baidu._g=baidu.dom._g,baidu.dom.insertAfter=function(e,t){var n,a;return n=baidu.dom._g,e=n(e),t=n(t),a=t.parentNode,a&&a.insertBefore(e,t.nextSibling),e},baidu.dom.remove=function(e){e=baidu.dom._g(e);var t=e.parentNode;t&&t.removeChild(e)},baidu.event=baidu.event||{},baidu.event._listeners=baidu.event._listeners||[],baidu.event.on=function(e,t,n){t=t.replace(/^on/i,""),e=baidu.dom._g(e);var a,r=function(t){n.call(e,t)},d=baidu.event._listeners,i=baidu.event._eventFilter,u=t;return t=t.toLowerCase(),i&&i[t]&&(a=i[t](e,t,r),u=a.type,r=a.listener),e.addEventListener?e.addEventListener(u,r,!1):e.attachEvent&&e.attachEvent("on"+u,r),d[d.length]=[e,t,n,r,u],e},baidu.on=baidu.event.on,baidu.object=baidu.object||{},baidu.extend=baidu.object.extend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},baidu.sio=baidu.sio||{},baidu.lang.isFunction=function(e){return"[object Function]"==Object.prototype.toString.call(e)},baidu.sio._createScriptTag=function(e,t,n){e.setAttribute("type","text/javascript"),n&&e.setAttribute("charset",n),e.setAttribute("src",t),document.getElementsByTagName("head")[0].appendChild(e)},baidu.sio._removeScriptTag=function(e){if(e.clearAttributes)e.clearAttributes();else for(var t in e)e.hasOwnProperty(t)&&delete e[t];e&&e.parentNode&&e.parentNode.removeChild(e),e=null},baidu.sio.callByServer=function(e,t,n){function a(e){return function(){try{e?s.onfailure&&s.onfailure():(t.apply(window,arguments),clearTimeout(d)),window[r]=null,delete window[r]}catch(n){}finally{baidu.sio._removeScriptTag(u)}}}var r,d,i,u=document.createElement("SCRIPT"),o="bd__cbs__",s=n||{},l=s.charset,c=s.queryField||"callback",p=s.timeOut||0,b=new RegExp("(\\?|&)"+c+"=([^&]*)");baidu.lang.isFunction(t)?(r=o+Math.floor(2147483648*Math.random()).toString(36),window[r]=a(0)):baidu.lang.isString(t)?r=t:(i=b.exec(e))&&(r=i[2]),p&&(d=setTimeout(a(1),p)),e=e.replace(b,"$1"+c+"="+r),e.search(b)<0&&(e+=(e.indexOf("?")<0?"?":"&")+c+"="+r),baidu.sio._createScriptTag(u,e,l)},baidu.string=baidu.string||{},baidu.string.format=function(e,t){e=String(e);var n=Array.prototype.slice.call(arguments,1),a=Object.prototype.toString;return n.length?(n=1==n.length?null!==t&&/\[object Array\]|\[object Object\]/.test(a.call(t))?t:n:n,e.replace(/#\{(.+?)\}/g,function(e,t){var r=n[t];return"[object Function]"==a.call(r)&&(r=r(t)),"undefined"==typeof r?"":r})):e},baidu.format=baidu.string.format,baidu.url=baidu.url||{},baidu.string.escapeReg=function(e){return String(e).replace(new RegExp("([.*+?^=!:${}()|[\\]/\\\\])","g"),"\\$1")},baidu.url.getQueryValue=function(e,t){var n=new RegExp("(^|&|\\?|#)"+baidu.string.escapeReg(t)+"=([^&#]*)(&|$|#)",""),a=e.match(n);return a?a[2]:null},window.bdPass=window.bdPass||{},window.bdPass.passchange=window.bdPass.passchange||function(){var e,t="https://passport.baidu.com/",n={outerDomId:"",tpl:"",weakPwdAvailable:!0,u:"",formId:"pass_passchange_form",formClassName:"pass_passchange_form_class",oldPwdLabel:"\u539f\u5bc6\u7801",oldPwdInputId:"pass_passchange_oldpwd",newPwdLabel:"\u65b0\u5bc6\u7801",newPwdInputId:"pass_passchange_newpwd",verifyPwdLabel:"\u786e\u8ba4\u65b0\u5bc6\u7801",verifyPwdInputId:"pass_passchange_verifypwd",tokenInputId:"pass_passchange_token",submitInputValue:"\u63d0\u4ea4\u4fee\u6539",submitInputId:"pass_passchange_submit",onSuccess:function(){},useCommonErrHandle:!0,onError:function(){},onReady:function(){}},a={1:{errInputId:n.oldPwdInputId,errWords:"\u8bf7\u8f93\u5165\u4f60\u7684\u539f\u5bc6\u7801"},2:{errInputId:n.newPwdInputId,errWords:"\u8bf7\u8f93\u5165\u4f60\u7684\u65b0\u5bc6\u7801"},3:{errInputId:n.verifyPwdInputId,errWords:"\u8bf7\u8f93\u5165\u4f60\u7684\u786e\u8ba4\u65b0\u5bc6\u7801"},5:{errInputId:n.newPwdInputId,errWords:"\u65b0\u5bc6\u7801\u5f3a\u5ea6\u5f31\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"},6:{errInputId:n.newPwdInputId,errWords:"\u65b0\u5bc6\u7801\u5f3a\u5ea6\u6781\u5f31\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"},7:{errInputId:n.newPwdInputId,errWords:"\u65b0\u5bc6\u7801\u9700\u89816\u81f314\u4f4d\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"},8:{errInputId:n.newPwdInputId,errWords:"\u5bc6\u7801\u7531\u6570\u5b57\uff0c\u5b57\u6bcd\u548c\u7b26\u53f7\u7ec4\u6210\uff0c\u5b57\u6bcd\u533a\u5206\u5927\u5c0f\u5199"},"-1":{errInputId:n.verifyPwdInputId,errWords:"\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"},11023:{errInputId:n.newPwdInputId,errWords:"\u65b0\u5bc6\u7801\u4e0e\u786e\u8ba4\u65b0\u5bc6\u7801\u4e0d\u5339\u914d\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"},11021:{errInputId:n.verifyPwdInputId,errWords:"\u539f\u59cb\u5bc6\u7801\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"},11024:{errInputId:n.verifyPwdInputId,errWords:"\u65b0\u5bc6\u7801\u4e0d\u7b26\u5408\u89c4\u8303\u6216\u5f3a\u5ea6\u5f31\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"},15015:{errInputId:n.verifyPwdInputId,errWords:"\u60a8\u672a\u767b\u5f55\u6216\u8005\u5df2\u88ab\u7cfb\u7edf\u81ea\u52a8\u767b\u51fa\uff0c\u767b\u5f55\u540e\u518d\u8bd5"},10:"\u60a8\u672a\u767b\u5f55\u6216\u8005\u5df2\u88ab\u7cfb\u7edf\u81ea\u52a8\u767b\u51fa\uff0c\u767b\u5f55\u540e\u518d\u8bd5"},r=function(e){if(e+="",a[e]||(e="-1"),n.onError(e),n.useCommonErrHandle&&(l(),a[e].errInputId)){var t=baidu.dom.create("SPAN",{id:"errSpan"}),r=baidu.g(a[e].errInputId);baidu.dom.insertAfter(t,r),t.innerHTML=a[e].errWords}},d=function(e,r){n=baidu.object.extend(n,e);for(var d in r)a[d]&&(a[d].errWords?a[d].errWords=r[d]:a[d]=r[d]);baidu.sio.callByServer(t+"api/?passchange&tpl="+n.tpl+"&callback="+u+"&tt="+(new Date).getTime(),u)},i=function(){e=baidu.dom.create("FORM",{id:n.formId,"class":n.formClassName,action:t+"api/?passchange",method:"post",target:"pass_passchange"}),e.innerHTML=baidu.string.format('<label for="#{oldPwdInputId}">#{oldPwdLabel}</label><input type="password" id="#{oldPwdInputId}" name="oldpwd" /><label for="#{newPwdInputId}">#{newPwdLabel}</label><input type="password" id="#{newPwdInputId}" name="newpwd"/><label for="#{verifyPwdInputId}">#{verifyPwdLabel}</label><input type="password" id="#{verifyPwdInputId}" name="verifypwd" /><input type="hidden" name="token" id="#{tokenInputId}" /><input type="hidden" name="tpl" value="#{tpl}" /><input type="hidden" name="u" value="#{u}" /><input type="button" id="#{submitInputId}" value="#{submitInputValue}" onclick="bdPass.passchange.submitFrom()" /><iframe name="pass_passchange" style="display:none"></iframe>',n),baidu.g(n.outerDomId).appendChild(e)},u=function(e){0==e.error_no?(i(),baidu.event.on(n.newPwdInputId,"blur",function(){s(!1)}),baidu.g(n.tokenInputId).value=e.token,n.onReady()):r(10)},o=function(){for(var e=[n.oldPwdInputId,n.newPwdInputId,n.verifyPwdInputId],t=0,a=e.length;a>t;t++)if(e[t]=baidu.g(e[t]).value,""==e[t]){switch(t){case 0:r(1);break;case 1:r(2);break;case 2:r(3)}return!1}return e[1]!=e[2]?(r(11023),!1):!0},s=function(e){var a=baidu.g(n.newPwdInputId).value||"";return l(),a?/^([0-9a-zA-Z\_`!~@#$%^*+=,.?;'":)(}{/\\\|<>&\[\-]|\])+$/.test(a)?a.length>14||a.length<6?(r(7),void 0):(e?c(t+"?weakpasscheck&fromreg=0&newpwd="+encodeURIComponent(a)+"&callback=bdPass.passchange.weakPwdCheckCallbackSubmit&t="+(new Date).getTime()+"&pspcs=utf8",bdPass.passchange.weakPwdCheckCallbackSubmit):c(t+"?weakpasscheck&fromreg=0&newpwd="+encodeURIComponent(a)+"&callback=bdPass.passchange.weakPwdCheckCallback&t="+(new Date).getTime()+"&pspcs=utf8",bdPass.passchange.weakPwdCheckCallback),void 0):(r(8),void 0):void 0},l=function(){baidu.g("errSpan")&&baidu.dom.remove(baidu.g("errSpan"))},c=function(e,t,n){if(!e||!baidu.lang.isString(e))return null;var a=baidu.url.getQueryValue(e,"callback"),r=document.createElement("SCRIPT");if(n)for(var d in n)r.setAttribute(d,n[d]);if(a){var i="CB"+Math.floor(2147483648*Math.random()).toString(36);e=e.replace(/(&|\?)callback=([^&]*)/,"$1callback="+i),window[i]=function(){try{var e=t||window[a];e.apply(null,arguments)}finally{r&&r.parentNode&&r.parentNode.removeChild(r),r=null,window[i]=null}}}else{var u=!1;r.onreadystatechange=r.onload=function(){if(u)return!1;if("undefined"==typeof r.readyState||"loaded"==r.readyState||"complete"==r.readyState){u=!0;try{t()}finally{r&&r.parentNode&&r.parentNode.removeChild(r),r.onreadystatechange=null,r.onload=null,r=null}}}}r.src=e,r.type="text/javascript";var o=document.getElementsByTagName("HEAD")[0];o.insertBefore(r,o.firstChild)};return{action:function(e,t){if(!(e&&e.tpl&&e.outerDomId&&e.u))throw new Error('config object must have keys named "tpl" & "outerDomId" & "u".');if(!baidu.g(e.outerDomId))throw new Error("can't find dom with id \""+e.outerDomId+'".');d(e,t)},weakPwdCheckCallback:function(e){switch(e+=""){case"1":if(!n.weakPwdAvailable)return r(5),!1;break;case"2":return r(6),!1}},weakPwdCheckCallbackSubmit:function(t){switch(t+=""){case"0":e.submit();break;case"1":if(!n.weakPwdAvailable)return r(5),!1;e.submit();break;case"2":return r(6),!1}},submitFrom:function(){o()&&s(!0)},postCallback:function(e){0==e?n.onSuccess():r(e)}}}();var PassportFillName=new function(){TbICom.call(this);var i=function(i,a){_.Module.use("common/widget/FillnameDialog",[i,a])};this.initSys("PassportFillName",[],{writeUname:i})};window.CommonUiDecorator=function(){this._priorityConfig={"default":0,hover:1,active:1,focus:2,error:10}},window.CommonUiDecorator.prototype={processEffect:function(e,t,c,f){var o=new RegExp("(^|\\s)"+t+"\\S+","g");e.getAttribute("effect_pri")<=this._priorityConfig[c]&&(e.className=e.className.replace(o,"")+" "+t+f,e.setAttribute("effect_pri",this._priorityConfig[f]))},clearEffect:function(e,t){this.forceEffect(e,t,"default")},forceEffect:function(e,t,c){var f=new RegExp("(^|\\s)"+t+"\\S+","g");e.className=e.className.replace(f,"")+" "+t+c,e.setAttribute("effect_pri",this._priorityConfig[c])},addEffects:function(e,t,c){var f=this;if(e.size()>0){null==c&&(c=[]);for(var o=0,i=c.length;i>o;o++)switch(c[o]){case"hover":e.hover(function(){f.processEffect(this,t,"hover","hover")},function(){f.processEffect(this,t,"hover","default")});break;case"active":e.mousedown(function(){f.processEffect(this,t,"active","active")}).mouseup(function(){f.processEffect(this,t,"active","default")});break;case"focus":e.focus(function(){f.processEffect(this,t,"focus","focus")}).blur(function(){f.processEffect(this,t,"focus","default")})}}}};var PassportSign=new function(){TbICom.call(this);var i=this,o=new window.CommonUiDecorator,n={dialog:null,action_type:"default",focus_tab:"normalLogin",jump_url:"",callback:null,action:{},trigger_pos:"",dialog_title:"\u767b\u5f55",onAfterLogined:null,dialogConfig:{width:598,height:"auto",title:"\u767b\u5f55",position:"center",holderClassName:"login_dialog"},loginFormConfig:{signClass:"comLoginForm",parentId:"",focus_tab:"normalLogin"},bdPassInstance:null,doAfterLogined:function(){if($.stats.sendRequest("st_type=login_succeed&fr=tb0&st_pos="+n.trigger_pos),!this.onAfterLogined||!this.onAfterLogined())if("function"==typeof n.callback)n.callback(),n.callback=null;else{var i=n.action_type;"function"==typeof n.action[i]?n.action[i]():(location.href.indexOf("index.html")>0&&TbCom.process("User","getUserInfoByRequest",s),n.reload())}},reload:function(){$.dialog.close(),setTimeout(function(){if(""!=n.jump_url)window.location.href=n.jump_url;else{var i=window.location.href,o=i.replace(/[&]?auth=[^&]*/,"").replace(/[&]?errno=[^&]*/,"");i==o?window.location.reload(!0):window.location.href=o}},200)},showDialog:function(o,s){var t=null;o in n&&(t=n.dialogConfig,"normalLogin"==o&&(t.title=n.dialog_title),this.dialog=$.dialog.open(n.buildWrapperHtml(o,"comLoginForm"),t),n[o].buildHtml(),this.showTypeImage(s),this.dialog.bind("onclose",function(){n[o].destroyLoginObj()}),"normalLogin"==o?i.dispatchEvent("showNormalLoginDialog",n):"phoneLogin"==o&&i.dispatchEvent("showPhoneLoginDialog",n))},showTypeImage:function(i){var o,n=this.dialog.getElement();switch(i){case"userBar":o=1;break;case"editor1":case"lzl":o=2;break;case"editor":o=3;break;case"lzonly":o=4;break;case"ilike":o=5;break;default:o=1}var s='<img src="//tb2.bdstatic.com/tb/static-common/img/passport/logindlg_pic'+o+'.png" width="220" height="276"/>';$(n).find(".j_passport_sign_asidearea").html(s)},showLoginForm:function(i){i=$.extend(n.loginFormConfig,i),$("#"+i.parentId).html(n.buildWrapperHtml(i.focus_tab,i.signClass,!0)),n[i.focus_tab].buildHtml(i)},init:function(o,s,t,e,a,r){var l=o||"normalLogin",p=s||"default";this.action_type=p,this.focus_tab=l,n.trigger_pos=a||"";var _=n.trigger_pos;n.dialog_title=r||n.dialog_title,this.callback=t||null,this.onAfterLogined=e&&e.onAfterLogined?e.onAfterLogined:function(){return!1};var d=TbCom.process("User","getRegPageUrl",n.trigger_pos);switch(_){case"userBar":_loginImg=1;break;case"editor1":case"lzl":_loginImg=2;break;case"editor":_loginImg=3;break;case"lzonly":_loginImg=4;break;case"ilike":_loginImg=5;break;default:_loginImg=1}var g=$.tb.location.getProtocol()+"//tb2.bdstatic.com/tb/static-common/img/passport/logindlg_pic"+_loginImg+".png",c=$.tb.location.getProtocol()+"//passport.baidu.com/js/pass_uni_loginWrapper.js?cdnversion=20121022";n.bdPassInstance?n.bdPassInstance.show(g):$.JsLoadManager.use(c,function(){n.bdPassInstance=bdPass.pop.init({staticpage:$.tb.location.getProtocol()+"//tieba.baidu.com/tb/v2Jump.html",apiopt:{tpl:"tb"},registerLink:d,onshow:function(){$.stats.sendRequest("st_type=login_start&fr=tb0&st_pos="+_),"normalLogin"==l?i.dispatchEvent("showNormalLoginDialog",n):"phoneLogin"==l&&i.dispatchEvent("showPhoneLoginDialog",n)},onLoginSuccess:function(o){o.returnValue=!1,"18"==o.errNo&&(realName?realName.show():(realName=passport.pop.init({type:"accRealName",tangram:!0,color:me.config.color||"",apiOpt:{u:location.href,product:"tb",staticPage:""},onHide:function(){"1"!=options.rspData.realnameswitch&&(args.isCompleted=!0,cfg.onCancel&&cfg.onCancel(args))},onSubmitSuccess:function(){args.isCompleted=!0,args&&args.rsp&&args.rsp.errInfo&&(args.rsp.errInfo.no="0"),options.rspData.hao123Param&&"1"==options.rspData.realnameswitch&&loginCrossToHao123(options.rspData.hao123Param),realName.hide(),cfg.onCancel&&cfg.onCancel(args)}}),realName.show())),n.doAfterLogined(),i.dispatchEvent("afterLogined",n)},onSubmitStart:function(i){$.stats.sendRequest("st_type=login_click&fr=tb0&st_pos="+_),i.submit()},img:g}),n.bdPassInstance.show()})},buildWrapperHtml:function(i,o,s){var t=this.action_type,e=t in n.header?n.header[t]:"",a=t in n.footer?n.footer[t]:"",r='<div id="pass_sign_body" class="'+o+'"><div class="pass_login_top_info resend_email_success" style="display:none"></div><div class="pass_login_top_error" style="display:none"><div class="login_top_error_content"></div></div><div class="clearDiv"></div><div class="passport_sign_Lcontent"><div class="passpost_sign_header">'+e+"</div>"+n.nav.buildHtml(i)+'<div class="passpost_sign_wrapper passpost_sign_wrapper_shape"><div class="passpost_sign_before_cnt"></div><div class="passpost_sign_cnt"></div><div class="passport_sign_user_info"></div><div class = "passpost_sign_after_cnt"></div></div><div class="passpost_sign_footer">'+a+"</div></div>";return s||(r+='<div class="j_passport_sign_asidearea passport_sign_Rcontent"></div>'),r+="</div>"},setConfig:function(){},initForeLoginForm:function(i){i.length>0&&n.loginForm.initMultiForeForm(i)}};n.header={example:"<p>this is the header</p>"},n.footer={example:"<p>this is the header</p>"},n.nav={items:{normalLogin:["\u666e\u901a\u767b\u5f55",""],phoneLogin:["\u624b\u673a\u767b\u5f55",""]},buildHtml:function(i){var o=['<div class="passpost_sign_nav"><ul>'],s="";for(var t in n.nav.items)s=t==i?'<li class="focus" data-login-type="'+t+'" data-account="" data-pwd=""><a href="#" onclick="return false">'+n.nav.items[t][0]+"</a></li>":'<li data-login-type="'+t+'"  data-account="" data-pwd=""><a href="#" onclick="return false">'+n.nav.items[t][0]+"</a></li>",o.push(s);return o.push('</ul><div class="passpost_sign_nav_line"></div></div>'),o.join("")},defaultTab:function(i){n.focus_tab=i},bindEventToNavItems:function(i){var o=$("#pass_sign_body"+i).find(".passpost_sign_nav li");o&&o.each(function(){$(this).bind("click",function(){$(this).hasClass("focus")||(n.nav.clearFocusToNavItems(i),$(this).addClass("focus"),n.loginForm.changLoginType($(this).attr("data-login-type")))})})},clearFocusToNavItems:function(i){$("#pass_sign_body"+i).find(".passpost_sign_nav li").each(function(){return $(this).hasClass("focus")?($(this).removeClass("focus"),void 0):void 0})}},n.normalLogin={class_name:"passport_normal_login",passApiConfig:{staticpage:$.tb.location.getProtocol()+"//tieba.baidu.com/tb/v2Jump.html",tpl:"tb",onSubmitStart:function(i){$("#pass_sign_body"+i).find(".pass_login_top_error").hide(),$.stats.sendRequest("st_type=login_click&fr=tb0&st_pos="+n.trigger_pos)},onSubmitedErr:function(i,o){var n=$("#pass_sign_body"+o),s=n.find(".pass_login_top_error");if(110024==i){var t=$("#pass_loginLite_err"+o);t.html("");var e='\u6b64\u5e10\u53f7\u8fd8\u672a\u6fc0\u6d3b\uff0c\u8bf7\u5230\u9a8c\u8bc1\u90ae\u4ef6\u4e2d\u6fc0\u6d3b\uff0c\u6216\u8005&nbsp;<span class="re_send_email">\u91cd\u53d1\u9a8c\u8bc1\u90ae\u4ef6</span>';return n.find(".login_top_error_content").html(e),n.find(".re_send_email").bind("click",function(){var i=$.trim($("#pass_loginLite_input_username"+o).val()),n="https://passport.baidu.com/v2/?regmailsend&callback=reSendEmailCallback&tpl=tb&user="+i+"&t="+(new Date).getTime();$.JsLoadManager.use(n),$(this).closest(".pass_login_top_error").hide()}),s.show(),void 0}s.hide()},onSuccess:function(o,s){$.cookie("TIEBA_LOGINED_USER",s.username||"",{expires:365,path:"/"}),n.doAfterLogined(),i.dispatchEvent("afterLogined",n)},onInputOk:function(i,n){$("#pass_loginLite_err"+n).html(""),o.clearEffect(i,"input_")},onInputErr:function(i,o,n){var s=$("#pass_sign_body"+n);s.find(".pass_login_top_error").hide(),120011==o&&$("#pass_loginLite_err"+n).html("\u8bf7\u586b\u5199\u5e10\u53f7")}},buildHtml:function(i){i||(i={}),i=$.extend(n.normalLogin.passApiConfig,i),$.stats.sendRequest("st_type=login_start&fr=tb0&st_pos="+n.trigger_pos),n.loginForm.init(i)},destroyLoginObj:function(){n.loginForm.destroyLoginForm(n.normalLogin.fIndex)}},n.phoneLogin={passApiConfig:{staticpage:$.tb.location.getProtocol()+"//tieba.baidu.com/tb/v2Jump.html",tpl:"tb",onSubmitStart:function(i){$("#pass_sign_body"+i).find(".pass_login_top_error").hide(),$.stats.sendRequest("st_type=login_click&fr=tb0&st_pos="+n.trigger_pos)},onSubmitedErr:function(i,o){var n=$("#pass_sign_body"+o),s=n.find(".pass_login_top_error");if(110024==i){var t=$("#pass_loginLite_err"+o);return n.find(".login_top_error_content").html(t.html()),t.html(""),s.show(),void 0}s.hide()},onSuccess:function(){n.doAfterLogined(),i.dispatchEvent("afterLogined",n)},onInputOk:function(i,n){$("#pass_loginLite_err"+n).html(""),o.clearEffect(i,"input_")},onInputErr:function(i,o,n){$("#pass_sign_body"+n).find(".pass_login_top_error").hide()}},buildHtml:function(i){i||(i={}),i=$.extend(n.phoneLogin.passApiConfig,i),$.stats.sendRequest("st_type=login_start&fr=tb0&st_pos="+n.trigger_pos),n.loginForm.init(i)}},n.loginForm={formIndex:0,defaultConf:{staticpage:$.tb.location.getProtocol()+"//tieba.baidu.com/tb/v2Jump.html",tpl:"tb",onSuccess:function(){n.doAfterLogined(),i.dispatchEvent("afterLogined",n)}},buildHtml:function(i){var o='<form id="pass_loginLite_form'+i+'" target="pass_loginLite_iframe'+i+'" class="pass_loginLite_form" onSubmit="javascript:return false"><p class="pass_loginLite_p_err"><span id="pass_loginLite_err'+i+'" class="pass_loginLite_err"></span></p><p class="login-input-p-username clearfix"><label id="pass_loginLite_label_username'+i+'" for="pass_loginLite_input_username'+i+'" class="pass_loginLite_item_desc">\u5e10\u53f7</label><input id="pass_loginLite_input_username'+i+'" class="pass_loginLite_input_username j_input_normal input_default" type="text"/><span class="tieba_loginLite_span_username">\u7528\u6237\u540d/\u9a8c\u8bc1\u90ae\u7bb1</span></p><p class="login-input-p clearfix"><label id="pass_loginLite_label_password'+i+'" for="pass_loginLite_input_password'+i+'" class="pass_loginLite_item_desc">\u5bc6\u7801</label><input id="pass_loginLite_input_password'+i+'" class="pass_loginLite_input_password j_input_normal input_default" type="password"/></p><p id="pass_loginLite_p_verifycode'+i+'" style="display:none" class="pass_loginLite_p_verifycode login-input-p clearfix"><label id="pass_loginLite_label_verifycode'+i+'" for="pass_loginLite_input_verifycode'+i+'" class="pass_loginLite_item_desc">\u9a8c\u8bc1\u7801</label><input id="pass_loginLite_input_verifycode'+i+'" class="pass_loginLite_input_verifycode j_input_normal input_default" type="text"/><span id="pass_loginLite_verifycodeImg_wrapper'+i+'" class="pass_loginLite_verifycodeImg_wrapper"></span><a id="pass_loginLite_a_verifycode'+i+'" href="#" class="pass_loginLite_verifycodeunclear">\u770b\u4e0d\u6e05\uff1f</a></p><p class="login-input-state-p clearfix"><input id="pass_loginLite_input_isMem'+i+'" type="checkbox" checked="checked"><label id="pass_loginLite_label_isMem'+i+'" class="pass_loginLite_label_isMem" for="pass_loginLite_input_isMem'+i+'">\u8bb0\u4f4f\u6211\u7684\u767b\u5f55\u72b6\u6001</label></p><p class="login-input-btn-p pass_login_p_submit"><input id="pass_loginLite_input_submit'+i+'" class="j_pass_loginLite_input_submit pass_loginLite_input_submit" type="submit" value="\u767b\u5f55"><a id="pass_loginLite_a_forgetpwd'+i+'" class="pass_loginLite_a_forgetpwd" href="https://passport.baidu.com/?getpass_index">\u5fd8\u8bb0\u5bc6\u7801\uff1f</a><div class="pass_loginLite_regguide">\u8fd8\u6ca1\u6709\u767e\u5ea6\u5e10\u53f7\uff1f<a id="pass_loginLite_a_toreg'+i+"\" class=\"pass_loginLite_a_toreg\" onclick=\"TbCom.process('User', 'buildRegisterFrame','"+n.trigger_pos+'\');return false" href="#">\u7acb\u5373\u6ce8\u518c</a></div></p><iframe name="pass_loginLite_iframe'+i+'" id="pass_loginLite_iframe'+i+'" src="javascript:\'\'" style="display:none;"></iframe></form>';return o},getDynamicFormIndexFromAPI:function(){return"undefined"!=typeof window.bdPass_api_loginLite_loaded?bdPass.api.loginLite.getSuggestFormIndexArray(1):[0]},destroyLoginForm:function(){bdPass.api.loginLite.destroy([n.loginForm.formIndex])},init:function(i){if(window.bdPass_api_loginLite_userCallBack=function(){try{bdPass.api.loginLite.setUserConf(i)}catch(o){}},"undefined"==typeof window.bdPass_api_loginLite_loaded){var o=$.tb.location.getProtocol()+"//passport.bdimg.com/js/pass_api_newLoginLiteWrapper_v2.js?cdnversion=20121022";return $.JsLoadManager.use(o,function(){var o=setInterval(function(){"undefined"!=typeof window.bdPass_api_loginLite_loaded&&(clearInterval(o),n.loginForm.loadFormHtml(i))},20)}),void 0}n.loginForm.loadFormHtml(i)},loadFormHtml:function(i){var o=n.loginForm.getDynamicFormIndexFromAPI();n.loginForm.formIndex=o[0];var s=$("#pass_sign_body"),t="pass_sign_body"+n.loginForm.formIndex;s.length>0&&s.attr("id",t),$("#"+t).find(".passpost_sign_cnt").html(n.loginForm.buildHtml(n.loginForm.formIndex));var e={formIndex:o[0],onFormReady:function(){n.loginForm.BindEventToForm(),n.nav.bindEventToNavItems(n.loginForm.formIndex)}};e=$.extend(i,e),bdPass.api.loginLite.init([e]);var a=$.cookie("TIEBA_LOGINED_USER");a&&($("span.tieba_loginLite_span_username").hide(),$("#pass_loginLite_input_username"+n.loginForm.formIndex).val(decodeURIComponent(decodeURIComponent(a))),$("#pass_loginLite_input_password"+n.loginForm.formIndex).focus())},changLoginType:function(i){var o=n.loginForm.formIndex,s=$("#pass_sign_body"+o);s.find(".pass_loginLite_err").html("");var t=s.find(".passpost_sign_nav").find(".focus"),e=t.attr("data-account"),a=t.attr("data-pwd");s.find(".pass_loginLite_input_username").val("").val($.trim(e)),s.find(".pass_loginLite_input_password").val("").val($.trim(a));var r=$(".tieba_loginLite_span_username"),l=$("#pass_loginLite_input_username"+o),p=$("#pass_loginLite_label_username"+o);return"phoneLogin"==i?(bdPass.api.loginLite.switchToPhoneState(o),r.hide(),p.html("\u624b\u673a\u53f7"),void 0):(""==l.val()&&r.show(),p.html("\u5e10\u53f7"),bdPass.api.loginLite.switchToNormalState(o),void 0)},BindEventToForm:function(){var i=n.loginForm.formIndex,s=$("#pass_sign_body"+i),t=$("#pass_loginLite_input_username"+i),e=$("#pass_loginLite_input_password"+i),a=s.find(".tieba_loginLite_span_username"),r=s.find(".passpost_sign_nav").find(".focus");"phoneLogin"==r.attr("data-login-type")&&a.hide(),""!=$.trim(t.val())&&a.hide();var l=1500,p=setInterval(function(){return""!=$.trim(t.val())?(a.hide(),clearInterval(p),void 0):0==l?(clearInterval(p),void 0):(l-=20,void 0)},20);t.bind("focus",function(){a.hide()}).bind("blur",function(){var i=s.find(".passpost_sign_nav").find(".focus");""==$.trim($(this).val())&&"phoneLogin"!=i.attr("data-login-type")&&a.show(),i.attr("data-account",$(this).val())}),e.bind("blur",function(){var i=s.find(".passpost_sign_nav").find(".focus");i.attr("data-pwd",$(this).val())}),a.bind("click",function(){t.focus()}),o.addEffects(s.find("input.j_input_normal"),"input_",["hover","focus"]),o.addEffects(s.find(".j_pass_loginLite_input_submit"),"pass_loginLite_input_submit_",["hover","active"])},initMultiForeForm:function(i){if(window.bdPass_api_loginLite_userCallBack=function(){try{bdPass.api.loginLite.setUserConf(n.loginForm.defaultConf)}catch(i){}},"undefined"==typeof window.bdPass_api_loginLite_loaded){var o=$.tb.location.getProtocol()+"//passport.bdimg.com/js/pass_api_newLoginLiteWrapper_v2.js?cdnversion=20121022";return $.JsLoadManager.use(o,function(){var o=setInterval(function(){"undefined"!=typeof window.bdPass_api_loginLite_loaded&&(clearInterval(o),bdPass.api.loginLite.init(i))},20)}),void 0}bdPass.api.loginLite.init(i)},resetEmail:function(i){var o=n.loginForm.formIndex,s=$("#pass_sign_body"+o).find(".pass_login_top_info");if(0==i.errno)return s.html("\u91cd\u53d1\u9a8c\u8bc1\u4fe1\u6210\u529f"),s.show(),setTimeout(function(){s.hide()},3e3),void 0;var t=$("#pass_loginLite_err"+o);t.html("\u91cd\u53d1\u9a8c\u8bc1\u4fe1\u5931\u8d25")}};var s=function(i){i.no_un||(location.href="/i/sys/jump")},t=function(i,o,s,t,e,a){n.init(i,o,s,t,e,a)},e=function(i){n.showLoginForm(i)},a=function(i){n.initForeLoginForm(i)},r=function(i){n.nav.defaultTab(i)},l=function(){n.reload()},p=function(i){n.jump_url=i};window.reSendEmailCallback=n.loginForm.resetEmail,this.doAfterLogined=n.doAfterLogined,this.initSys("PassportSign",[],{showDialog:t,showLoginForm:e,initForeLoginForm:a,defaultTab:r,reload:l,setJumpURL:p})};!new function(){TbICom.call(this);var e,t=$.extend({},window.PageData&&window.PageData.user),n={},a=0;_infoCompleteStack=[],_infoReq=null,_isInited=!1,_self=this;var o={my_forum:{complete:!1,url:"/f/user/json_myforum"},my_club:{complete:!1,url:"/club/common/getuserclub"}},s="/f/user/json_userinfo",i=!1,r="http://msg.baidu.com/ms?ct=18",c=function(n){_isInited||(t=$.extend(!0,{},n),e=window.PageData?window.PageData.product||window.PageData.page:"other",_isInited=!0,_self.dispatchEvent("init"),d())},d=function(){t.is_login&&t.no_un&&($.cookie("NO_UNAME")||(TbCom.process("User","buildUnameFrame","\u6b22\u8fce\u6765\u5230\u8d34\u5427","\u8d77\u4e2a\u54cd\u4eae\u7684\u540d\u5b57\uff0c\u4eab\u53d7\u66f4\u591a\u8d34\u5427\u529f\u80fd\uff01"),$.cookie("NO_UNAME",1,{expires:30})),$("body").mousedown(function(e){for(var t=e.target;"BODY"!=t.tagName;){if($(t).attr("data-checkun")){$(t).attr("onclick","return false").unbind("click"),TbCom.process("User","buildUnameFrame");break}t=t.parentNode}}))},u=function(){return _isInited},l=function(e,t){TbCom.process("PassportFillName","writeUname",e,t)},f=function(e,t,n,a){_.Module.use("tbui/widget/LoginDialog",["",a])},m=function(e,t){TbCom.process("PassportSign","showLoginForm",{signClass:t,parentId:e})},p=function(e){var t="/i/sys/user_json?v="+(new Date).getTime(),n=TbUtil.getCheckedValue("reg_recommended_cnt","recommended_user",",");$.get(t,{},function(t){var a=$.json.decode(t);if(a.tbs){var o="/i/commit",s={cmd:"follow_all",tbs:a.tbs};s.portraits=n,$.post(o,s,function(){e&&"function"==typeof e&&e()})}})},g=function(e){var t=w(e);window.open(t)},w=function(){var e="",t=document.location.toString()||"";switch(!0){case t.indexOf("/index.html")>0:e="index";break;case t.indexOf("/i/")>0:e="itieba";break;case t.indexOf("/p/")>0:e="pb";break;case t.indexOf("/f?")>0:e="frs";break;case t.indexOf("/imall/mall")>0:e="bbx";break;default:e=""}var n="//passport.baidu.com/v2/?reg&tpl=tb&";return n+="u="+document.location},b=function(e){TbCom.process("PassportSign","initForeLoginForm",e)},v=function(){return t},h=function(e){e&&"function"==typeof e&&(i&&e(t),P(e))},y=function(){return e},k=function(e,t){e&&""!=e&&t&&"function"==typeof t&&o.hasOwnProperty(e)&&(o.complete?t(n[e]):x(e,t))},P=function(e){e&&"function"==typeof e&&_infoCompleteStack.push(e),$.inArray(a,[0,3])>-1&&($.tb.ajax({url:s,success:function(e){if(i=!0,a=2,e.data&&e.data.is_login){var n=e.data;if(n.weak_pwd&&C(n.user_name_weak,n.user_portrait),t.name_url=n.user_name_url||"","undefined"==typeof t.name&&(t.name=n.user_name_url||""),t.portrait=n.user_portrait||"",t.has_space=n.user_open_space||"",t.feedNumNew=n.feedNumNew||"",t.name_weak=n.user_name_weak||"",t.name_link=n.user_name_link||"",t.name_show=n.user_name_show||"",t.mobilephone=n.mobilephone||"",t.email=n.email||"",t.no_un=n.no_un,t.sid=n.session_id,t.itieba_id=n.user_itieba_id,t.source_id=n.source_id,t.is_half_user=n.is_half_user,_infoCompleteStack.length)for(var o=0;o<_infoCompleteStack.length;o++)"function"==typeof _infoCompleteStack[o]&&_infoCompleteStack[o].call(null,t);_self.dispatchEvent("infoComplete",t)}},error:function(){a=3}}),a=1)},C=function(e,t){$.stats.sendRequest("fr=tb0_forum&st_mod=common_logic&st_type=pwdresetpop&st_value="+t);var n='<div class="resetPwdBanner"><p class="pwdBannertip"><strong>'+e+'</strong>\uff0c\u7cfb\u7edf\u68c0\u6d4b\u5230\u60a8\u7684\u5bc6\u7801\u8fc7\u4e8e\u7b80\u5355\u3002\u7531\u4e8e\u60a8\u6b63\u5728\u62c5\u4efb\u70ed\u95e8\u8d34\u5427\u7684\u5427\u4e3b\u6216\u5c0f\u5427\u4e3b\uff0c\u8bf7\u60a8\u82b1\u4e00\u5206\u949f\u6765\u4fee\u6539\u5bc6\u7801\uff0c\u4fdd\u62a4\u81ea\u5df1\u7684\u8d26\u53f7\u5b89\u5168\u4e5f\u662f\u4fdd\u62a4\u81ea\u5df1\u7684\u5bb6\u3002</p></div><div id="resetPwdWrapDiv"></div>',a=new $.dialog.open(n,{title:"\u91cd\u7f6e\u5bc6\u7801\uff0c\u4fdd\u62a4\u60a8\u7684\u91cd\u8981\u6743\u5229",width:560,draggable:!1,closeable:!1,escable:!1});a.hide(),setTimeout(function(){$("#pass_passchange_form").length<=0?$("#resetPwdWrapDiv").html('<div class="passResetOk">\u7cfb\u7edf\u51fa\u73b0\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u60a8\u5237\u65b0\u9875\u9762\u91cd\u8bd5\u3002</div>').removeClass():a.show()},1500),bdPass.passchange.action({outerDomId:"resetPwdWrapDiv",tpl:"tb",weakPwdAvailable:!1,oldPwdLabel:"\u539f\u5bc6\u7801\uff1a",newPwdLabel:"\u65b0\u5bc6\u7801\uff1a",verifyPwdLabel:"\u786e\u8ba4\u65b0\u5bc6\u7801\uff1a",submitInputValue:"\u4fee\u6539\u5bc6\u7801",onSuccess:function(){$("#resetPwdWrapDiv").html('<div class="passResetOk">'+e+"\uff0c\u60a8\u7684\u5bc6\u7801\u5df2\u7ecf\u4fee\u6539\u6210\u529f</div>").removeClass(),$.stats.sendRequest("fr=tb0_forum&st_mod=common_logic&st_type=pwdresetok&st_value="+e),setTimeout(function(){$.dialog.close(),window.location.reload()},2500)},u:"//tieba.baidu.com/tb/passchange.html",onReady:function(){U("pass_passchange_form","pass_passchange_newpwd",6,14)}},{5:"\u60a8\u7684\u65b0\u5bc6\u7801\u7ed3\u6784\u592a\u8fc7\u7b80\u5355\uff0c\u4e3a\u4e86\u60a8\u7684\u8d26\u53f7\u5b89\u5168\uff0c\u8bf7\u66f4\u6362\u66f4\u590d\u6742\u7684\u5bc6\u7801\u3002",6:"\u60a8\u7684\u65b0\u5bc6\u7801\u7ed3\u6784\u592a\u8fc7\u7b80\u5355\uff0c\u4e3a\u4e86\u60a8\u7684\u8d26\u53f7\u5b89\u5168\uff0c\u8bf7\u66f4\u6362\u66f4\u590d\u6742\u7684\u5bc6\u7801\u3002"})},U=function(e,t,n,a){var o="undefined"==typeof currentPwdCheckId?0:currentPwdCheckId++,s="#pwdrate"+o,i="setBar"+o,r=["\u5f3a","\u5f31","\u6781\u5f31","&nbsp;","\u592a\u77ed","\u592a\u957f"],c=["#080","#a03","#a03","#fff","#f00","#f00"],d='<div id="pwdrate'+o+'" class="pwdrate"><span class="pwdrate_title">\u5bc6\u7801\u5f3a\u5ea6\uff1a</span><strong class="pwdrate_word">&nbsp;</strong><table cellspacing="1"><tbody><tr><td id="ratebar_lef"></td><td id="ratebar_mid"></td><td id="ratebar_rig"></td></tr></tbody></table><div class="pwdrate_tips">\u4e3a\u4e86\u4fdd\u969c\u60a8\u7684\u8d26\u53f7\u5b89\u5168\u6027\uff0c\u65b0\u5bc6\u7801\u4e0d\u80fd\u5c11\u4e8e6\u4f4d\u4e14\u5fc5\u987b\u540c\u65f6\u5305\u542b\u5927\u5c0f\u5199\u82f1\u6587\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u7279\u6b8a\u5b57\u7b26\u4e2d\u81f3\u5c11\u4efb\u610f\u4e24\u79cd\u7ec4\u5408\u3002</div></div>';$("#"+e).after(d),window[i]=function(e){$(s+" .pwdrate_word").html(r[e]).css({color:c[e]}),$(s+" table").removeClass().addClass("rate"+e)},$("#"+t).keyup(function(){var e=$("#"+t).val(),o=e.length;if(n>o||o>a){var d=n>o?0>=o?3:4:5;$(s+" .pwdrate_word").html(r[d]).css({color:c[d]}),$(s+" table").removeClass()}else{var u="http://passport.baidu.com/?weakpasscheck&newpwd="+escape(e)+"&fromreg=0&callback="+i;$.getScript(u)}})},x=function(e,t){o.hasOwnProperty(e)&&$.tb.ajax({url:o[e].url,success:function(a){o[e].complete=!0,n[e]=a.data||null,t&&"function"==typeof t&&t(n[e]),_self.dispatchEvent("dataComplete",e,n[e])}})},D=function(e){var t={};$.JsLoadManager.use(r,function(){"number"==typeof msgnum&&(t.msgnum=msgnum),"number"==typeof sysnum&&(t.sysnum=sysnum),"string"==typeof redmsg&&(t.redmsg=redmsg),"string"==typeof tv&&(t.tv=tv),e&&"function"==typeof e&&e(t),_self.dispatchEvent("userMessageComplete",t)})},I=function(){if(t.is_login){var e=window.location.href,n=new RegExp("/i/","g");if(null!==e.match(n)){var a=new RegExp("#","g");e=e.replace(a,""),e+="?fr=itb_logout"}var o="https://passport.baidu.com/?logout&aid=6&sid="+t.sid.slice(0,64)+"&u="+String(e).escapeUTF8();window.location.href=o}},N=function(e,t,n){if(n&&"function"==typeof n){var a={ct:486539264,cm:59107,lm:e,word:t,tn:"resultNo"},o="/f";$.get(o,a,function(e){var t=$.json.decode(e);n(!(!t||!t.hasOwnProperty("resultNo")||0!=t.resultNo))},"html")}};this.initSys("User",[],{init:c,getManagerInit:u,buildUnameFrame:l,buildLoginFrame:f,buildBareLoginFrame:m,initForeLoginForm:b,buildRegisterFrame:g,activeItieba:p,getRegPageUrl:w,getUserInfo:v,getUserInfoByRequest:h,getPageProduct:y,getUserData:k,requestUserData:x,requestUserMessage:D,logout:I,doSthIsLogin:N})};var LCFManager=new function(){var e,t=this,n=!1;this.API={msgStatus:function(){$(t).trigger("sendStatus",arguments)},bindServer:function(){$(t).trigger("bindServer")},closeServer:function(){$(t).trigger("closeServer")},newClient:function(){$(t).trigger("newClient",arguments)},onReady:function(){$(t).trigger("ready")},onHost:function(){$(t).trigger("bindHost",arguments)},onMessage:function(){$(t).trigger("message",arguments)},inGroup:function(){$(t).trigger("joinGroup",arguments)},console:function(e,t){t&&t in $.console?$.console[t](e):$.console.debug(e)},jsCheck:function(){return!0}};var r=function(){e={}};this.init=function(e){n||(r(e),$.console.debug("LCF \u5f00\u59cb\u521d\u59cb\u5316!"),n=!0)},this.checkSWFReady=function(){try{return e.remote("checkSWF")}catch(t){return!1}},this.sendMsg=function(t){var n=t.target,r=t.group;""==n||"all"==n?e.remote("sendMsg",t.id,t.content,r,t.client,t.saveAble):"own"==n?e.remote("sendOwnMsg",t.id,t.content,t.saveAble):"other"==n?e.remote("sendOtherMsg",t.id,t.content,r,t.saveAble):"host"==n&&e.remote("sendMsgToHost",t.id,t.content,r,t.saveAble)},this.getMsg=function(t){return t&&""!=t?e.remote("getMsg",t):e.remote("getAllMsg")},this.removeMsg=function(t){t&&""!=t?e.remote("removeMsg",t):e.remote("removeAllMsg")},this.createRequest=function(t){var n=e.remote("createRequest",t);return n},this.sendRequest=function(t,n){e.remote("sendRequest",t,n)},this.createListen=function(t){var n=e.remote("createListen",t);return n},this.startListen=function(t){e.remote("sendListen",t)},this.stopListen=function(t){e.remote("cancelListen",t)},this.setServer=function(t){switch(t){case"open":e.remote("startServer");break;case"close":e.remote("stopServer");break;case"restart":e.remote("restartServer")}},this.setClient=function(t,n){"bindHost"==t?e.remote("bindHost",n):"insertGroup"==t&&e.remote("bindHost",n)},this.so=function(t,n){return t&&""!=t?n&&""!=n?e.remote("sharedObjectWrite",t,n):e.remote("sharedObjectRead",t):null},this.addEvent=function(){return $(t).bind.apply($(t),arguments)},this.removeEvent=function(){return $(t).unbind.apply($(t),arguments)}};var MessageProxy={receiveMsg:function(e,n,t){var r=null,c=e,l=c.indexOf("_"),s="custom",u="";return-1==l?u=c:(s=c.slice(0,l),u=c.slice(l+1)),r={},r.mod=s,r.type=u,r.content=n,r.time=t,r},createMsgId:function(e,n){return e&&n?e+"_"+n:(e?e:"")+(n?n:"")},createMsg:function(e,n,t,r,c,l,s){var u={},a=MessageProxy.createMsgId(n,t);return u.target=e,u.id=a,u.content=r?r:null,u.group=c?c:null,u.client=l?l:null,u.saveAble=!!s,u}};var SWFListen=function(){var n,o,t={},r=(new Date).getTime()+"_"+Math.floor(100*Math.random()),e=this,i=function(i){var u='window.SWFListen.API["'+r+'"]';o=LCFManager,t.url=i.url||"",t.method=i.method||"get",t.data=i.data||{},t.onComplete=u+'["onComplete"]',t.onProgress=u+'["onProgress"]',t.onOpen=u+'["onOpen"]',t.onIOError=u+'["onIOError"]',t.onSecurityError=u+'["onSecurityError"]',t.onListenStatus=u+'["onListenStatus"]',s(),n=o.createListen(t),i&&(i.onComplete&&"function"==typeof i.onComplete&&$(e).bind("complete",i.onComplete),i.onProgress&&"function"==typeof i.onProgress&&$(e).bind("progress",i.onProgress),i.onOpen&&"function"==typeof i.onOpen&&$(e).bind("open",i.onOpen),i.onIOError&&"function"==typeof i.onIOError&&$(e).bind("IOError",i.onIOError),i.onSecurityError&&"function"==typeof i.onSecurityError&&$(e).bind("securityError",i.onSecurityError),i.onListenStatusChange&&"function"==typeof i.onListenStatusChange&&$(e).bind("statusChange",i.onListenStatusChange))},s=function(){window.SWFListen=window.SWFListen||{},window.SWFListen.API=window.SWFListen.API||{},window.SWFListen.API[r]={onComplete:u,onProgress:a,onOpen:g,onIOError:p,onSecurityError:c,onListenStatus:f}},u=function(n){$(e).trigger("complete",n)},a=function(n){$(e).trigger("progress",n)},g=function(){$(e).trigger("open")},p=function(){$(e).trigger("IOError")},c=function(){$(e).trigger("securityError")},f=function(n){n?$(e).trigger("statusChange",!0):$(e).trigger("statusChange",!1)};this.start=function(){o.startListen(n)},this.stop=function(){o.stopListen(n)},this.addEvent=function(){$(e).bind.apply($(e),arguments)},this.removeEvent=function(){$(e).unbind.apply($(e),arguments)},i.apply(this,arguments)};var SWFRequest=function(){var o,r,n={},e=(new Date).getTime()+"_"+Math.floor(100*Math.random()),t=this,i=function(i){var s='window.SWFRequest.API["'+e+'"]';r=LCFManager,n.url=i.url||"",n.method=i.method||"get",n.data=i.data||{},n.onComplete=s+'["onComplete"]',n.onProgress=s+'["onProgress"]',n.onOpen=s+'["onOpen"]',n.onIOError=s+'["onIOError"]',n.onSecurityError=s+'["onSecurityError"]',u(),o=r.createRequest(n),i&&(i.onComplete&&"function"==typeof i.onComplete&&$(t).bind("complete",i.onComplete),i.onProgress&&"function"==typeof i.onProgress&&$(t).bind("progress",i.onProgress),i.onOpen&&"function"==typeof i.onOpen&&$(t).bind("open",i.onOpen),i.onIOError&&"function"==typeof i.onIOError&&$(t).bind("IOError",i.onIOError),i.onSecurityError&&"function"==typeof i.onSecurityError&&$(t).bind("securityError",i.onSecurityError))},u=function(){window.SWFRequest=window.SWFRequest||{},window.SWFRequest.API=window.SWFRequest.API||{},window.SWFRequest.API[e]={onComplete:s,onProgress:p,onOpen:c,onIOError:g,onSecurityError:d}},s=function(o){$(t).trigger("complete",o)},p=function(o){$(t).trigger("progress",o)},c=function(){$(t).trigger("open")},g=function(){$(t).trigger("IOError")},d=function(){$(t).trigger("securityError")};this.send=function(n){r.sendRequest(o,n)},this.addEvent=function(){$(t).bind.apply($(t),arguments)},this.removeEvent=function(){$(t).unbind.apply($(t),arguments)},i.apply(this,arguments)};!new function(){TbICom.call(this);var e,n,t,s=this,o=function(){},r={setServer:o,addEvent:o,init:o,sendMsg:o,getMsg:o},i=!0,a=3e5,c="/messagepool/online",u="/messagepool/listen",d=!0,l=!0,g=Math.floor(100*Math.random())+"_"+(new Date).getTime(),v=function(){var e=TbCom.process("User","getUserInfo");e.is_login&&e.portrait?(t=e.portrait,f(e.portrait)):TbCom.process("User","getUserInfoByRequest",function(n){e=n,t=e.portrait,f(t)})},f=function(e){r.addEvent("ready",M),r.addEvent("bindServer",y),r.addEvent("closeServer",w),r.addEvent("bindHost",S),r.addEvent("newClient",b),r.addEvent("message",_),r.addEvent("joinGroup",C);var n=$.getBrowser().name;if($.inArray(n,["ie","chrome","firefox","safari"])<0)try{window.addEventListener("beforeunload",function(){r.setServer("close")},!1)}catch(t){window.attachEvent("onbeforeunload",function(){r.setServer("close")})}else try{window.addEventListener("unload",function(){r.setServer("close")},!1)}catch(t){window.attachEvent("onunload",function(){r.setServer("close")})}r.init("TBMSG_"+e),$.console.debug("\u6d88\u606f\u7cfb\u7edf\u5f00\u59cb\u542f\u52a8 [ TBMSG_"+e+" ]")},p=function(){var e=new SWFListen({url:u+"?user="+t+"&c="+g});return e},m=function(){var e=(new Date).getTime(),n=c+"?user="+t+"&t="+e,s=new Image;window.tb_online_stats=s,s.src=n},h=function(){E(),m(),e=setInterval(m,a)},E=function(){e&&(clearInterval(e),e=null)},M=function(){$.console.debug("\u6d88\u606f\u7cfb\u7edf\u51c6\u5907\u5b8c\u6bd5\uff01"),i=!0,s.dispatchEvent("ready")},y=function(){l=!0,h(),n||(n=p()),n.addEvent("statusChange",I),n.addEvent("complete",T),n.start(),$.console.debug("\u6210\u4e3aserver\uff01"),s.dispatchEvent("bindServer")},w=function(){l=!1,E(),n&&(n.removeEvent("statusChange",I),n.removeEvent("complete",T),n.stop()),$.console.debug("server\u5173\u95ed\uff01"),s.dispatchEvent("closeServer")},S=function(e,n,t){$.console.debug(n+"\u6ce8\u518c\u6210\u4e3a["+t+"]\u7684host client\uff01"),s.dispatchEvent("bindHost",n,t)},b=function(e,t){if($.console.debug("\u6709\u65b0\u7684\u5ba2\u6237\u7aef\u8fde\u63a5 ["+t+"]"),l){var o=n?"1":"0";x({id:"chat_command_listen",content:o,group:"default",client:_newClient,saveAble:!1}),$.console.debug("MsgSystem : tell new client listen status - "+_islistening)}s.dispatchEvent("newClient",t)},_=function(e,n,t,o){$.console.debug("\u6536\u5230\u65b0\u7684\u6d88\u606f [ "+n+"; "+t+"; "+o+" ]");var r=MessageProxy.receiveMsg(n,t,o);s.dispatchEvent(r.mod+"_message",r)},C=function(e,n){$.console.debug("\u52a0\u5165\u4e00\u4e2a\u6d88\u606f\u7ec4 [ "+n+" ]"),s.dispatchEvent("joinGroup",n)},I=function(e){d=!!e,$.console.debug("@MsgSystem : Listen status change - "+d),s.dispactchEvent("listenStatusChange",e)},T=function(e,n){$.console.warn(n);var t=n.replace(/^TbNet.dataHandler\(|\)\;?$/g,"");t=t.replace(/\:\'\[/g,":["),t=t.replace(/\]\'\}/g,"]}"),s.dispatchEvent("listenComplete",$.json.decode(t))},x=function(e,n,t,s,o,i,a){j(function(){var c=MessageProxy.createMsg(e,n,t,s,o,i,a);r.sendMsg(c)})},L=function(e,n){j(function(){if(e&&n){var t=MessageProxy.createMsgId(e,n);return r.getMsg(t)}return r.getMsg()})},B=function(e,n){j(function(){var t=MessageProxy.createMsgId(e,n);r.removeMsg(t)})},F=function(e,n){j(function(){var t=L();for(var s in t)0==s.indexOf(e)&&(msg_type=s.slice(e.length+1),msg_type!=n&&B(e,msg_type))})},R=function(e){return new SWFRequest(e)},U=function(e){return new SWFListen(e)},W=function(e){j(function(){r.setServer(e)})},A=function(e,n){j(function(){r.setClient(e,n)})},G=function(e,n){j(function(){return r.so(e,n)})},P=function(){return i},j=function(){var e=arguments[0];if(e&&"function"==typeof e){for(var n=new Array,t=1;t<arguments.length;t++)n.push(arguments[t]);P()?e.apply(s,n):s.addEvent("ready",function(){e.apply(s,n)})}};this.initSys("MsgSystem",["User"],{init:v,sendMsg:x,getMsg:L,removeMsg:B,removeMsgByMod:F,createSWFRequest:R,createSWFListen:U,setServer:W,setClient:A,so:G,getIsReady:P,doSomethingAfterReady:j})};var initItiebaMessage;!new function(){TbICom.call(this);var e,t,i,s,a,n="",r=[],o=0,l=[],p={atme:0,light:0,reply:0,favts:0,recycle:0},c="default",u=!1,d={all_msg:{id:0,display:!0,aside_tip_id:"",url:""},fans:{id:1,url:"#itb_home#&type=fans",aside_tip_id:"",display:!1},____prop_out_of_date:{id:2,url:"/tbmall/message",aside_tip_id:"tbmall_num_tip",display:!0},scores:{id:3,url:"/tbmall/getTdou",aside_tip_id:"tbmall_num_tip",display:!0},reply:{id:4,url:"#itb_home#&type=replyme",aside_tip_id:"new_reply_num_tip",display:!1},feature:{id:5,url:"#itb_home#&type=feature",aside_tip_id:"new_feature_num_tip",display:!0},guess:{id:6,url:"#itb_home#&type=main",aside_tip_id:"new_guess_num_tip",display:!0},postPasser:{id:8,display:!1},atme:{id:9,url:"#itb_home#&type=atme",aside_tip_id:"new_atme_num_tip",display:!1},recycle:{id:10,url:"/pmc/recycle",aside_tip_id:"new_recycle_num_tip",display:!0},invite:{id:11,url:"#itb_home#",aside_tip_id:"new_invite_num_tip",display:!0},prop_out_of_date:{id:12,url:"/tbmall/message",aside_tip_id:"tbmall_num_tip",display:!0},paperprops:{id:16,url:"//tieba.baidu.com/tb/zt/tietiao/index.html",aside_tip_id:"new_paperprops_num_tip",display:!0},gameOpen:{id:17,url:"/game/index",aside_tip_id:"new_gameOpen_num_tip",display:!0},lotteryDraw:{id:18,url:"/f?kw=%B2%CA%C6%B1&tab=lc_mylottery#/user/order",aside_tip_id:"new_lotteryDraw_num_tip",display:!0},lotteryAward:{id:19,url:"/f?kw=%B2%CA%C6%B1&tab=lc_mylottery#/user/account",aside_tip_id:"new_lotteryAward_num_tip",display:!0},favts:{id:20,url:"#itb_home#&type=storethread",aside_tip_id:"new_storethread_num_tip",display:!1},meizhiLevelUp:{id:15,url:"#other_url#?type=meizhiLevelUp",aside_tip_id:"new_meizhiLevelUp_tip",display:!0},friendapply:{id:22,url:"#itb_home#&type=friendapply",aside_tip_id:"new_friendapply_num_tip",display:!1}},f={itb_home:""},m=function(e){t=e,i=$("#com_userbar");TbCom.process("MsgSystem","getIsReady");y()},y=function(){if(!u){"itieba"!=t&&(n="_blank");var e=TbCom.process("User","getUserInfo");e&&e.is_login&&e.portrait?g(e):TbCom.process("User","getUserInfoByRequest",g),u=!0}},g=function(t){e=t.portrait,f.itb_home="/i/sys/jump?u="+e;for(var i in d)r[d[i].id]=i;for(var s in d){var a=d[s];if("undefined"!=typeof a.url)switch(s){case"guess":d[s].url=a.url.replace(/#itb_home#/g,"/i/app/"+s+"?uc="+e);break;case"invite":d[s].url=a.url.replace(/#itb_home#/g,"/f/i/invite");break;case"meizhiLevelUp":d[s].url=a.url.replace(/#other_url#/g,"/encourage/get/meizhi/jump");break;default:d[s].url=a.url.replace(/#itb_home#/g,"/i/sys/jump?u="+e)}}h(),v();var n=this;TbCom.addEvent("MsgSystem","sys_message",function(){z.apply(n,arguments),TbCom.trigger&&TbCom.trigger("msgsystem_message",arguments)}),TbCom.addEvent("MsgSystem","listenComplete",function(){j.apply(n,arguments),TbCom.trigger&&TbCom.trigger("msgsystem_listencomplete",arguments)}),M()},b=null,h=function(){var e=r,t=[];t.push('<div class="allMsg" style="clear:both;"><ul>');for(var n=0,o=e.length;o>n;n++)t.push('<li id="message_'+e[n]+'" style="display:none;"></li>');t.push("</ul>"),t.push('<div class="tb_msg_tip_rightpanel">'),t.push('<a href="'+f.itb_home+'&type=profile#notify" style="height:100%;" target="_self" class="setting">\u8bbe\u7f6e</a>'),t.push('<a title="\u5173\u95ed" href="#" onclick="return false;" class="close_msg_tip"></a>'),t.push('<b style="clear:both; text-align:left;"></b>'),t.push("</div></div>");var l=$("#com_userbar").find(".u_setting .u_menu_setting"),p=l.offset().left,c=p?p:0,u=$("body").width();_right=u-c-100,_right=_right>350?180:_right;var d={content:t.join(""),arrow_dir:"up",bubble_css:{right:10,width:170,top:25},arrow_pos:{left:140},level:2,attr:" id='com_userbar_message' ",wrap:i};_.Module.use("tbui/widget/bubble_tip",d,function(e){b=e,e.setFixedForMessage(),s=e.j_bubble,a=e}),$("#mobile_promote_download").bind("click",function(){_.Module.use("common/component/diversionDialog",[],function(e){e.showDiversionDialog("webtbnews")})})},v=function(){$("body").on("click",".close_msg_tip",function(){return b&&b.hideBubble(),TbCom.process("UserMessage","clearAllData"),$(this).closest(".allMsg").find(".j_clear_notify").each(function(){var e=$(this).getData().type;$.tb.Storage.remove(e)}),!1}),$(window).on("beforeunload",function(){var e=0,t=l.length;for(o=1;t>e;e++)window.Notification?l[e].close():window.webkitNotifications&&l[e].cancel()})},w=function(e){TbCom.process("MsgSystem","doSomethingAfterReady",function(){e()})},M=function(){var t="/messagepool/get_data",i=t+"?user="+e;$.JsLoadManager.use(i)},k=function(e){w(function(){switch(e){case"favts":S();break;default:T(e),U(e)}})},T=function(t){var i=(new Date).getTime(),s=d[t].id;if(20!==s){var a="/messagepool/clear_data?type="+s+"&user="+e+"&stamp="+i,n=new Image;window["itieba_msg_clearer_"+i]=n,n.src=a}},C=function(){w(function(){for(var e in d)"all_msg"!=e&&T(e);D()})},I=function(){},S=function(){},N=function(e){TbCom.trigger&&TbCom.trigger("msgsystem_initall",e);var t=e.join(",");I(),Z(t),TbCom.process("MsgSystem","sendMsg","other","sys","all_msg",t,"default",null,!1)};initItiebaMessage=N;var U=function(e){w(function(){e&&""!=e&&TbCom.process("MsgSystem","sendMsg","all","sys",e,"0","default",null,!1)})},D=function(){TbCom.process("MsgSystem","sendMsg","all","sys","clear_msg","all","default",null,!1),TbCom.process("MsgSystem","removeMsgByMod","sys","command_listen"),S()},A=function(){var e="/f?ct=486539264&cm=59202&tn=jsonUserInfo&t="+Math.random();$.get(e,{},function(e){var t=$.json.decode(e);t.beans_num&&(TbCom.process("MsgSystem","sendMsg","all","sys","wealth",t.beans_num,"default",null,!1),setTimeout(function(){T("wealth"),TbCom.process("MsgSystem","removeMsg","sys","wealth")},100))})},j=function(e,t){for(var i=t.mod,s=0,a=t.msg.length;a>s;s++){var n=r[t.msg[s].type],o=t.msg[s].cnt;if("sys"==i&&"wealth"==n)return A(),void 0;TbCom.process("MsgSystem","sendMsg","all",i,n,o,"default",null,!1)}},z=function(e,t){if(t){var i=t.type,s=t.content;i&&"undefined"!=typeof s?L(i,s):$.console.debug("@UserMessage _renderMsg : \u8fd4\u56de\u7684\u6570\u636e\u4e2d\u6ca1\u6709type\u548ccontent")}else $.console.debug("@UserMessage _renderMsg : \u4e0d\u9700\u8981\u5904\u7406\uff01")},L=function(e,t){switch(e){case"all_msg":Z(t);break;case"fans":B(t);break;case"scores":x(t);break;case"reply":R(t),F();break;case"feature":E(t);break;case"guess":W(t);break;case"atme":X(t),F();break;case"prop_out_of_date":O(t);break;case"invite":H(t);break;case"paperprops":J(t);case"favts":break;case"friendapply":q(t);break;case"recycle":P(t),F();break;case"clear_msg":Y(t);break;case"gameOpen":V(t);break;case"meizhiLevelUp":G(t);break;case"lotteryDraw":K(t);break;case"lotteryAward":Q(t);default:$.console.debug("@UserMessage _renderMsgHandler; LCF\u8fd4\u56de\u7684\u6d88\u606f\u6ca1\u6709\u5904\u7406\u51fd\u6570")}},B=function(e){var t=parseInt(e);t>0?(st("fans",t,"\u65b0\u7c89\u4e1d"),it("fans",t,"\u65b0\u7c89\u4e1d")):at("fans")},O=function(e){var t=parseInt(e);t>0?(st("prop_out_of_date",t,"T\u8c46\u5546\u57ce\u4fe1\u606f"),it("prop_out_of_date",t,"T\u8c46\u5546\u57ce\u4fe1\u606f")):at("prop_out_of_date")},x=function(e){var t=parseInt(e);t>0?(st("scores",t,"\u8d60\u900110T\u8c46\u4fe1\u606f"),it("scores",t,"\u8d60\u900110T\u8c46\u4fe1\u606f")):at("scores")},E=function(e){var t=parseInt(e),i=$("#new_feature_num_tip"),s="";t>0?(st("feature",t,"\u65b0\u7cbe\u54c1"),it("feature",t,"\u65b0\u7cbe\u54c1"),s="("+e+"\u65b0)"):at("feature"),i&&i.html(s)},R=function(e){var t=parseInt(e);p.reply=t,t>0?(st("reply",t,"\u65b0\u56de\u590d"),it("reply",t,"\u65b0\u56de\u590d")):at("reply")},F=function(){var e=p.reply+p.atme+p.light+p.recycle;if(e>0){var t=$("#new_reply_num_tip"),i="";i="("+e+"\u65b0)",t&&t.html(i)}else var t=$("#new_reply_num_tip").html("")},q=function(e){var t=parseInt(e);if(p.friendapply=t,t>0){var i=$("#new_friendapply_num_tip"),s="";s="("+t+"\u65b0)",i&&i.html(s),st("friendapply",t,"\u65b0\u7684\u597d\u53cb\u7533\u8bf7"),it("friendapply",t,"\u65b0\u7684\u597d\u53cb\u7533\u8bf7"),$.stats.sendRequest("fr=tb0_forum&st_mod=msgsys&st_type=friendapplyshow")}else at("friendapply")},P=function(e){var t=parseInt(e);p.recycle=t,t>0?(st("recycle",t,"\u56de\u6536\u7ad9\u63d0\u9192"),it("recycle",t,"\u56de\u6536\u7ad9\u63d0\u9192")):at("recycle")},W=function(e){var t=parseInt(e);t>0?(st("guess",t,"\u7ade\u731c\u7ed3\u679c"),it("guess",t,"\u7ade\u731c\u7ed3\u679c")):at("guess")},H=function(e){var t=parseInt(e);p.invite=t,t>0?(st("invite",t,"\u7c89\u4e1d\u798f\u5229\u5361"),it("invite",t,"\u7c89\u4e1d\u798f\u5229\u5361")):at("invite")},J=function(e){var t=parseInt(e);p.paperprops=t,t>0?(st("paperprops",t,"\u8d34\u6761\u9053\u5177\u4fe1\u606f"),it("paperprops",t,"\u8d34\u6761\u9053\u5177\u4fe1\u606f")):at("paperprops")},V=function(e){var t=parseInt(e);t>0?(st("gameOpen",t,"\u6e38\u620f\u5f00\u670d\u901a\u77e5"),it("gameOpen",t,"\u6e38\u620f\u5f00\u670d\u901a\u77e5")):at("gameOpen")},G=function(e){var t=parseInt(e);t>0?(st("meizhiLevelUp",null,"\u59b9\u7eb8\uff0cMvp\u5347\u7ea7\u4e86\uff01"),it("meizhiLevelUp",null,"\u59b9\u7eb8\uff0cMvp\u5347\u7ea7\u4e86\uff01")):at("meizhiVote")},K=function(e){var t=parseInt(e);t>0?(st("lotteryDraw",t,"\u5f69\u7968\u5f00\u5956\u63d0\u9192"),it("lotteryDraw",t,"\u5f69\u7968\u5f00\u5956\u63d0\u9192")):at("lotteryDraw")},Q=function(e){var t=parseInt(e);t>0?(st("lotteryAward",t,"\u5f69\u7968\u4e2d\u5956\u63d0\u9192"),it("lotteryAward",t,"\u5f69\u7968\u4e2d\u5956\u63d0\u9192")):at("lotteryAward")},X=function(e){var t=parseInt(e);p.atme=t,t>0?(st("atme",t,"@\u63d0\u5230\u6211"),it("atme",t,"@\u63d0\u5230\u6211")):at("atme")},Y=function(){for(var e=s,t=e.find("li"),i=0,a=t.length;a>i;i++)$(t[i]).css("display","none");e.css("display","none");var n=null,r="";for(var o in d)r=d[o].aside_tip_id,"string"==typeof r&&""!=r&&(n=$("#"+r),n&&(n.html(""),n.css("display","none")))},Z=function(e){for(var t,i=e.split(","),s=r,a=s.length-1,n=0,o=i.length;o>n;n++)num=i[n],a>n&&(t=s[n+1],L(t,num))},et=function(e){c=e},tt=function(){return window.Notification&&"granted"==window.Notification.permission||window.webkitNotifications&&0==window.webkitNotifications.checkPermission()},it=function(e,t,i){var s=function(e,t,i){tt()&&(this.notify=null,this.init(e,t,i))};return s.conf={title:"\u8d34\u5427\u6d88\u606f\u901a\u77e5",icon:{}},s.prototype={constructor:s,init:function(e,t,i){var a=s.conf.title,n="/tb/static-common/img/notify/"+e+".png",r="\u60a8\u6709"+t+"\u4e2a"+i,o=d[e].url;$.tb.Storage.get(e)!=t&&(this.createNotify(a,n,r,e),this.setEvent(e,t,o),l.push(this.notify),$.tb.Storage.set(e,t))},createNotify:function(e,t,i,s){var a=null;(a=window.Notification)?this.notify=new Notification(e,{icon:t,body:i,tag:s}):(a=window.webkitNotifications)&&(this.notify=a.createNotification(t,e,i),this.notify.replaceId=s,this.notify.show())},closeNotify:function(e){window.Notification?e.currentTarget&&e.currentTarget.close():window.webkitNotifications&&e.currentTarget.cancel()},setEvent:function(e,t,i){var s=this,a=s.notify,n=0;a.ondisplay=function(e){var t=setTimeout(function(){n=1,s.closeNotify(e),clearTimeout(t)},2e4)},a.onshow=function(e){var t=20;$.browser.mozilla&&(t=3);var i=setTimeout(function(){n=1,s.closeNotify(e),clearTimeout(i)},1e3*t)},a.onclick=function(e){s.closeNotify(e),window.open(i)},a.onclose=function(){1!=n&&1!=o&&(k(e),$.tb.Storage.remove(e))},a.onerror=function(){}}},new s(e,t,i)},st=function(e,t,i){var s=$("#message_"+e)||null,r=d[e];if(0!=r.display&&s){var o=(r.id,r.url),l=$("<span>"+t+"\u4e2a</span>"),p=$('<a class="j_clear_notify">'+i+"</a>").bindData({type:e});p.tbattr({href:o,target:n}),p.bind("click",function(){k(e),$.tb.Storage.remove(e),$.stats.track((e||"")+"_click","user_message")}),s.html(""),null!==t&&s.append(l),s.append(p),s.css("display","block"),a&&a.showBubble(),$("#u_xiangce").find(".j_wrap").hide()}},at=function(e){var t=$("#message_"+e),i=s;if(i){var a=i.find("li");t.css("display","none");for(var n=!0,r=0,o=a.length;o>r;r++)if("none"!=$(a[r]).css("display")){n=!1;break}i.css("display",n?"none":"block")}},nt=function(e,t){e&&e in d&&(d[e].display=!!t)};this.initSys("UserMessage",["User","MsgSystem","WealthSystem"],{init:m,clearSysMsg:U,clearData:k,clearAllData:C,setWealthActionType:et,setMsgDisplay:nt})};!function(e){function o(e){if(0!=e.length){var o=new Image(1,1),t="img_"+ +new Date,a=[],n=e.split("&");a.push("ts=9mp&t=csp&sid="+v+"&dv=5&page="+encodeURIComponent(l.pageId)+"&p="+encodeURIComponent(l.productId)+"&type=CROSS_SITE_RES");for(var r=0;r<n.length;++r)a.push("desc"+r+"="+n[r]);h[t]=o,o.onload=o.onerror=function(){h[t]=o=o.onload=o.onerror=null,delete h[t]},o.src=g+"/tb/pms/img/st.gif?"+a.join("&")}}function t(e){return e=e.replace(/\s/g,"").replace(/\./g,"\\.").replace(/\*/g,".*").replace(/\?/g,"."),"^"+e+"$"}function a(){for(var e=l["default-exclude"],o=0;o<e.length;++o){var a=RegExp(t(e[o]),"i");s.push(a)}1==l["exclude-host"]&&s.push(RegExp(I,"i"))}function n(){var e=window.performance.getEntriesByType("resource");window.performance.clearResourceTimings&&window.performance.clearResourceTimings();for(var t=0;t<e.length;++t){var a=e[t].name;if(a&&void 0==m[a]){var n=a.match(f);if(n){n=n[1],/[:@]/.test(n)&&(n=n.split("@").pop().split(":")[0]);for(var r=0;r<s.length;++r){var i=s[r];if(i.test(n)){m[a]=1;break}}a.indexOf(g)>=0&&(m[a]=1),void 0==m[a]&&(m[a]=0)}}}var p=[],c=0;for(var d in m)if(0==m[d]){var l=encodeURIComponent(d);c+l.length>=u&&(c>0&&o(p.join("&")),c=0,p=[]),c+=l.length,p.push(l),m[d]=1}p.length>0&&o(p.join("&"))}function r(){var e=48,o=2,t=1e4,a=0,i=setInterval(function(){a++},16),p=0,c=setInterval(function(){e>a?p=0:++p==o&&(clearInterval(i),clearInterval(c),n(),setTimeout(r,t)),a=0},1e3)}function i(){a(),window.performance&&window.performance.getEntriesByType&&r()}var p={index:{pv:65e6,pageId:"14_329",leakPageId:"14_342"},frs:{pv:13e7,pageId:"14_331",leakPageId:"14_343"},pb:{pv:3e8,pageId:"14_333",leakPageId:"14_344"},ihome:{pv:3e6,pageId:"14_321",leakPageId:"14_341"},tbmall:{pv:3e6,pageId:"14_322",leakPageId:"14_345"},itieba3:{pv:5e6,pageId:"14_323",leakPageId:"14_346"},other:{pv:3e5,pageId:"14_327",leakPageId:"14_347"}},c=PageData.product||PageData.page||"other",d=p[c]?c:"other",l={sample:1e5/p[d].pv,"exclude-host":"https:"==window.location.protocol?!1:!0,"default-exclude":"https:"==window.location.protocol?[]:["*.bdstatic.com","*.baidu.com","*.tiebaimg.com","*.bdimg.com","*.duoku.com","*.bcebos.com","*.ykimg.com","*.youku.com"],productId:14,pageId:"https:"==window.location.protocol?p[d].leakPageId:p[d].pageId},g="http://static.tieba.baidu.com";"https:"==window.location.protocol&&(g="https://gsp0.baidu.com/5aAHeD3nKhI2p27j8IqW0jdnxx1xbK");var s=[],m={},u=1200,I=location.hostname,h={},v=e.logId||(+new Date).toString(36)+Math.random().toString(36).substr(2,3),f=/^(?:http?:\/\/)([^\/]+)/i;Math.random()<=l.sample&&i()}(window);